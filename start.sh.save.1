#!/bin/bash

echo "[start.sh] Usuwam i tworzę FIFO..."
rm -f fifo_boat1 fifo_boat2
mkfifo fifo_boat1 fifo_boat2

echo "[start.sh] Tworzę kolejkę komunikatów MSG_KEY=1234..."

# Uruchomienie procesów
echo "[start.sh] Uruchamiam statek 1..."
./statek 1 fifo_boat1 &
STATEK1_PID=$!

echo "[start.sh] Uruchamiam statek 2..."
./statek 2 fifo_boat2 &
STATEK2_PID=$!

echo "[start.sh] Uruchamiam sternik..."
./sternik &
STERNIK_PID=$!

echo "[start.sh] Uruchamiam kasjer..."
./kasjer &
KASJER_PID=$!

echo "[start.sh] Uruchamiam pomost..."
./pomost &
POMOST_PID=$!

echo "[start.sh] FIFO dla boat1 i boat2 oraz sternik gotowe. Rozpoczynam uruchamianie pasażerów..."

# Czekaj na zakończenie procesów
wait $STATEK1_PID $STATEK2_PID $STERNIK_PID $KASJER_PID $POMOST_PID
